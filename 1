2025-12-23 17:29:41,423 - hypercorn.error - ERROR - Error in ASGI Framework
Traceback (most recent call last):
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/hypercorn/asyncio/task_group.py", line 28, in _handle
    await app(scope, receive, send, sync_spawn, call_soon)
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/hypercorn/app_wrappers.py", line 34, in __call__
    await self.app(scope, receive, send)
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/fastapi/applications.py", line 1106, in __call__
    await super().__call__(scope, receive, send)
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/starlette/applications.py", line 122, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/starlette/middleware/errors.py", line 184, in __call__
    raise exc
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/ssaAgent/orchestration-system/main.py", line 89, in cert_auto_login
    return await call_next(request)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/starlette/middleware/sessions.py", line 86, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/newPython/lib/python3.12/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/ssaAgent/orchestration-system/controller/routes/agents.py", line 236, in list_agents
    allowed_environments = get_user_allowed_environments(db, user)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/ssaAgent/orchestration-system/controller/routes/agents.py", line 147, in get_user_allowed_environments
    environments = db.get_user_environments(user_id)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ADMIN/Oracle/Toolkits/deployStage/tools/python/ssaAgent/orchestration-system/controller/db/db.py", line 799, in get_user_environments
    rows = self.query(query, (user_id,))
           ^^^^^^^^^^
AttributeError: 'OrchestrationDB' object has no attribute 'query'
